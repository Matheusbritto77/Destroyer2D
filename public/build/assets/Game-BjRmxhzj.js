import{d as dt,q as A,s as rt,e as ft,o as ct,a as c,t as B}from"./app-B0Fjlqq2.js";const gt={class:"relative w-full h-screen bg-black text-white overflow-hidden"},ut={class:"absolute top-0 left-0 w-full text-center z-10 p-4 bg-gradient-to-b from-black/70 to-transparent"},wt={class:"text-lg"},pt={class:"mr-6"},xt={class:"mr-6"},mt={class:"mr-6"},vt=800,yt=15,Mt={__name:"Game",setup(bt){const W=dt(100),s=A({level:1,phase:"basic",score:0,health:500,bossDefeated:!1,phaseStartTime:Date.now()});let D=0,R=0,I=0,a,h,i,g=[],f=[],u=[],v={},C=0,w=[];const T=A({value:30});rt(()=>{P(),N(),q(),O(),y()});let S=new Image;S.src="navs/basic.png",S.onload=()=>{console.log("Imagem da nave inimiga básica carregada com sucesso!")},S.onerror=()=>{};let M=new Image;M.src="navs/medium.png",M.onload=()=>{},M.onerror=()=>{};let E=new Image;E.src="navs/boss.png",E.onload=()=>{},E.onerror=()=>{};function L(){W.value=Math.round(i.shield)}function P(){a=document.getElementById("gameCanvas"),h=a.getContext("2d"),window.innerWidth<=768?(a.width=window.innerWidth*.75,a.height=window.innerHeight*.75):(a.width=window.innerWidth,a.height=window.innerHeight),a.style.width=`${window.innerWidth}px`,a.style.height=`${window.innerHeight}px`}function N(){i={x:a.width/2-15,y:a.height-60,width:30,height:30,speed:10,shield:1e3,maxShield:1e3,image:new Image},i.image.src="/navs/padraoplayer.png",i.image.onload=()=>{console.log("Imagem da nave carregada com sucesso!")}}function O(){let t=!1;const e=120;a.addEventListener("touchstart",l=>{t=!0,l.preventDefault()},{passive:!1}),a.addEventListener("touchmove",l=>{if(!t)return;const o=l.touches[0],n=a.getBoundingClientRect(),d=o.clientX-n.left,m=o.clientY-n.top-e,p=d-(i.x+i.width/2),r=m-(i.y+i.height/2),x=Math.sqrt(p*p+r*r),Y=Math.min(x,i.speed),X=p/x,_=r/x;!isNaN(X)&&!isNaN(_)&&(i.x+=X*Y,i.y+=_*Y),i.x=Math.max(0,Math.min(a.width-i.width,i.x)),i.y=Math.max(0,Math.min(a.height-i.height,i.y)),l.preventDefault()},{passive:!1}),a.addEventListener("touchend",()=>{t=!1})}function V(){T.value=20+(s.level-1)*5}function q(){window.addEventListener("keydown",t=>v[t.key]=!0),window.addEventListener("keyup",t=>{v[t.key]=!1})}function y(t){const o=1e3/(window.innerWidth<=768?30:60);y.lastTime||(y.lastTime=t),t-y.lastTime>=o&&(h.clearRect(0,0,a.width,a.height),b(),F(),y.lastTime=t),requestAnimationFrame(y)}function b(){G(),j(),z(),K(),Z(),L(),et(),tt();const t=Date.now();b.lastBonusSpawn||(b.lastBonusSpawn=0);const n=Math.max(2e3,1e4-200*(s.level+1));t-b.lastBonusSpawn>n&&(Q(),b.lastBonusSpawn=t)}function F(){st(),at(),ot(),nt(),ht()}function G(){v.ArrowLeft&&i.x>0&&(i.x-=i.speed),v.ArrowRight&&i.x<a.width-i.width&&(i.x+=i.speed),v.ArrowUp&&i.y>0&&(i.y-=i.speed),v.ArrowDown&&i.y<a.height-i.height&&(i.y+=i.speed),$()}function $(){if(I>0){I--;return}if(R>0){R--;return}g.push({x:i.x+i.width/2-2,y:i.y,width:5,height:30,speed:s.level>1?10+s.level*.2:10}),D++,R=5,D>=10&&(D=0,I=s.level>1?15-s.level*.2:15)}function j(){g=g.filter(t=>t.y>0),g.forEach(t=>t.y-=t.speed)}function z(){u=u.filter(t=>t.y<a.height),u.forEach(t=>t.y+=t.speed)}function K(){f=f.filter(e=>e.y<a.height);const t=s.level;f.forEach(e=>{if(e.y+=e.speed,e.type==="medium"){const o=e.moveFrequency||.03,n=e.moveAmplitude||20,d=e.movePhase||0;e.x+=Math.sin(e.y*o+d)*(n*.05),e.x=Math.max(0,Math.min(a.width-e.width,e.x))}e.type==="boss"&&t>=1&&U(e,t);const l=.005+t*.002;(e.type==="medium"||e.type==="basic")&&Math.random()<l&&u.push({x:e.x+e.width/2-2,y:e.y+e.height,width:7,height:10,speed:4+t*.5})})}function U(t,e){const l=window.innerWidth<=768,o=t.originalWidth||t.width,n=t.originalHeight||t.height;t.originalWidth||(t.originalWidth=t.width),t.originalHeight||(t.originalHeight=t.height),l?(t.width=o/2,t.height=n/2):(t.width=o,t.height=n);const d=window.innerWidth,m=window.innerHeight;a.width=Math.min(a.width,d),a.height=Math.min(a.height,m);const p=a.width,r=a.height;t.x<=0?(t.x=0,t.speed=Math.abs(t.speed)):t.x+t.width>=p&&(t.x=p-t.width,t.speed=-Math.abs(t.speed)),t.y+t.height>=r&&(t.y=r-t.height),t.y<0&&(t.y=0),t.x+=t.speed,t.y<0&&t.y+t.height>0&&(t.y+=2);const x=.04+e*.01;Math.random()<x&&J(t)}function J(t){[{offsetX:0,offsetY:0,dx:-1,dy:-1},{offsetX:t.width,offsetY:0,dx:1,dy:-1},{offsetX:0,offsetY:t.height,dx:-1,dy:1},{offsetX:t.width,offsetY:t.height,dx:1,dy:1},{offsetX:t.width/2,offsetY:0,dx:0,dy:-1},{offsetX:0,offsetY:t.height/2,dx:-1,dy:0},{offsetX:t.width,offsetY:t.height/2,dx:1,dy:0},{offsetX:t.width/2,offsetY:t.height,dx:0,dy:1}].forEach(l=>{u.push({x:t.x+l.offsetX-2,y:t.y+l.offsetY-5,width:4,height:10,speed:2+s.level*.2,dx:l.dx,dy:l.dy})})}function Q(){if(w.length>=3)return;const t=45,e=45,l=Math.random()*(a.width-t),o=-45,n=Math.random()<.5?"health":"shield",d=[1,2,3,4,5,6,7,8,9,10][Math.floor(Math.random()*10)];w.push({x:l,y:o,width:t,height:e,speed:2,type:n,multiplier:d,value:10,collected:!1})}function Z(){w=w.filter(t=>t.y<a.height&&!t.collected),w.forEach(t=>{t.y+=t.speed})}function tt(){const t=Date.now();if(t-C<vt||f.length>=3)return;const e=s.level,l=(t-s.phaseStartTime)/1e3,o=30+e*15,n=1.5+e*.5,d=10+e*5;l>=30&&s.phase!=="boss"&&(s.phase=s.phase==="basic"?"medium":"boss",s.phaseStartTime=t),s.phase==="basic"?k("basic",50,20,n,o,d):s.phase==="medium"?k("medium",80,25,n*1.2,o*1.5,d*1.2):s.phase==="boss"&&!s.bossDefeated&&!f.find(m=>m.type==="boss")&&k("boss",500,100,.6+e*.1,o*10,d*3,a.width/2-100),C=t}function k(t,e,l,o,n,d,m=Math.random()*(a.width-e)){let p=0,r=0;t==="medium"?(r=30+s.level*20,p=r):t==="boss"&&(r=150+s.level*50,p=r);const x={x:m,y:0,width:e,height:l,speed:o,health:n,maxHealth:n,damage:d,type:t,shield:p,maxShield:r};t==="basic"?x.image=S:t==="medium"?x.image=M:t==="boss"&&(x.image=E),f.push(x)}function et(){for(let t=g.length-1;t>=0;t--){const e=g[t];for(let l=w.length-1;l>=0;l--){const o=w[l];if(H(e,o)){it(o),w.splice(l,1),g.splice(t,1);break}}for(let l=f.length-1;l>=0;l--){const o=f[l];if(H(e,o)){let n=T.value;o.shield>0&&(o.shield>=n?(o.shield-=n,n=0):(n-=o.shield,o.shield=0)),n>0&&(o.health-=n),g.splice(t,1),o.health<=0&&(f.splice(l,1),s.score+=o.type==="boss"?100:10,o.type==="boss"&&(s.bossDefeated=!0,lt()));break}}}for(let t=u.length-1;t>=0;t--){const e=u[t];if(H(e,i)){u.splice(t,1);let l=yt;i.shield>0&&(i.shield>=l?(i.shield-=l,l=0):(l-=i.shield,i.shield=0)),l>0&&(s.health-=l),s.health<=0&&Swal.fire({icon:"error",title:" Game Over!",text:`Seu score: ${s.score}`,confirmButtonText:"Recomeçar",allowOutsideClick:!1,allowEscapeKey:!1}).then(()=>{location.reload()})}}for(let t=f.length-1;t>=0;t--);}function H(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}function it(t){const e=t.value*t.multiplier;t.type==="health"?s.health=Math.min(s.health+e,1e3):t.type==="shield"&&(i.shield=Math.min(i.shield+e,i.maxShield),L())}function lt(){s.level++,s.health+=100,s.phase="basic",s.bossDefeated=!1,s.phaseStartTime=Date.now(),V()}function st(){i.image.complete?h.drawImage(i.image,i.x,i.y,i.width,i.height):(h.fillStyle="lime",h.fillRect(i.x,i.y,i.width,i.height)),i.maxShield>0&&(h.fillStyle="gray",h.fillRect(i.x,i.y-12,i.width,6),h.fillStyle="deepskyblue",h.fillRect(i.x,i.y-12,i.shield/i.maxShield*i.width,6));const t=500;h.fillStyle="gray",h.fillRect(i.x,i.y-6,i.width,6),h.fillStyle="green",h.fillRect(i.x,i.y-6,s.health/t*i.width,6)}function at(){g.length!==0&&(h.fillStyle="red",g.forEach(t=>h.fillRect(t.x,t.y,t.width,t.height)))}function ot(){u.length!==0&&(h.fillStyle="yellow",u.forEach(t=>h.fillRect(t.x,t.y,t.width,t.height)))}function ht(){w.length!==0&&w.forEach(t=>{h.fillStyle=t.type==="health"?"green":"deepskyblue",h.fillRect(t.x,t.y,t.width,t.height),h.fillStyle="white",h.font="16px Arial",h.fillText("x"+t.multiplier,t.x+5,t.y+18)})}function nt(){const t=window.innerWidth<=768;f.forEach(e=>{t&&e.type==="boss"&&(e.width=e.originalWidth?e.originalWidth/2:e.width/2,e.height=e.originalHeight?e.originalHeight/2:e.height/2),e.image&&e.image.complete?h.drawImage(e.image,e.x,e.y,e.width,e.height):(h.fillStyle=e.type==="basic"?"red":e.type==="medium"?"orange":"purple",h.fillRect(e.x,e.y,e.width,e.height)),e.maxShield>0&&(h.fillStyle="gray",h.fillRect(e.x,e.y-16,e.width,5),h.fillStyle="lightblue",h.fillRect(e.x,e.y-16,e.shield/e.maxShield*e.width,5)),h.fillStyle="green",h.fillRect(e.x,e.y-8,e.health/e.maxHealth*e.width,5)})}return(t,e)=>(ct(),ft("div",gt,[e[4]||(e[4]=c("canvas",{id:"gameCanvas",class:"w-full h-full"},null,-1)),c("div",ut,[e[0]||(e[0]=c("br",null,null,-1)),e[1]||(e[1]=c("br",null,null,-1)),e[2]||(e[2]=c("br",null,null,-1)),e[3]||(e[3]=c("h1",{class:"text-4xl font-bold mb-2"}," Destroyer 2D",-1)),c("div",wt,[c("span",pt,"Score: "+B(s.score),1),c("span",xt,"Level: "+B(s.level),1),c("span",mt,"Shield: "+B(W.value)+"%",1),c("span",null,"Health: "+B(s.health)+"%",1)])])]))}};export{Mt as default};
